<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>v2ray安装注意记录 - hellojxl</title><link rel="icon" type="image/png" href=icons/myicon.png /><meta name="viewport" content="width=device-width, initial-scale=1">
	<meta property="og:title" content="v2ray安装注意记录" />
<meta property="og:description" content="原因 新购了一个国外VPS，肯定要(你懂的)，主机商提供了三种系统，Ubuntu、Debian和Centos，由于某些原因三种系统都轮流安装了一遍，或者说都虐了一遍了，其中经历惨不忍睹啊！
相关问题 不得不说v2ray的官方文档还是很齐全的，但是由于linux的版本太多过程还是会遇到问题的，所以具体的安装文档还是参照官方文档，我这里只是记录遇到的问题
 问题一：Centos7下Nginx下无法进行数据转发，报Permission Denied
解决方法：可以参考白话配置,不过我这里由于是VPS的问题，SELinux被主机商禁用了，开启不了，只能更换系统 问题二：Debian下SSL版本低，这个算不上问题，只是我这升级完ssl出现好多问题，果断更换系统，没办法，自己太菜🐶，关键是不明白什么主机商提供的Debian8的ssl协议竟然这么低。 问题三：Centos6下提示出错：Install daemon fail, please install it manually
解决方法：原来是因为不支持centos6，参考这里，具体如下： 新建/etc/init.d/v2ray,并添加下面的配置  #!/bin/sh## v2ray Startup script for v2ray## chkconfig: - 24 76# processname: v2ray# pidfile: /var/run/v2ray.pid# description: V2Ray proxy services#### BEGIN INIT INFO# Provides: v2ray# Required-Start: $network $local_fs $remote_fs# Required-Stop: $remote_fs# Default-Start: 2 3 4 5# Default-Stop: 0 1 6# Short-Description: V2Ray proxy services# Description: V2Ray proxy services### END INIT INFODESC=v2rayNAME=v2rayDAEMON=/usr/bin/v2ray/v2rayPIDFILE=/var/run/$NAME." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.hellojxl.com/posts/v2ray%E5%AE%89%E8%A3%85%E6%B3%A8%E6%84%8F%E8%AE%B0%E5%BD%95/" />
<meta property="article:published_time" content="2018-07-27T21:02:19+00:00" />
<meta property="article:modified_time" content="2018-07-27T21:02:19+00:00" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="v2ray安装注意记录"/>
<meta name="twitter:description" content="原因 新购了一个国外VPS，肯定要(你懂的)，主机商提供了三种系统，Ubuntu、Debian和Centos，由于某些原因三种系统都轮流安装了一遍，或者说都虐了一遍了，其中经历惨不忍睹啊！
相关问题 不得不说v2ray的官方文档还是很齐全的，但是由于linux的版本太多过程还是会遇到问题的，所以具体的安装文档还是参照官方文档，我这里只是记录遇到的问题
 问题一：Centos7下Nginx下无法进行数据转发，报Permission Denied
解决方法：可以参考白话配置,不过我这里由于是VPS的问题，SELinux被主机商禁用了，开启不了，只能更换系统 问题二：Debian下SSL版本低，这个算不上问题，只是我这升级完ssl出现好多问题，果断更换系统，没办法，自己太菜🐶，关键是不明白什么主机商提供的Debian8的ssl协议竟然这么低。 问题三：Centos6下提示出错：Install daemon fail, please install it manually
解决方法：原来是因为不支持centos6，参考这里，具体如下： 新建/etc/init.d/v2ray,并添加下面的配置  #!/bin/sh## v2ray Startup script for v2ray## chkconfig: - 24 76# processname: v2ray# pidfile: /var/run/v2ray.pid# description: V2Ray proxy services#### BEGIN INIT INFO# Provides: v2ray# Required-Start: $network $local_fs $remote_fs# Required-Stop: $remote_fs# Default-Start: 2 3 4 5# Default-Stop: 0 1 6# Short-Description: V2Ray proxy services# Description: V2Ray proxy services### END INIT INFODESC=v2rayNAME=v2rayDAEMON=/usr/bin/v2ray/v2rayPIDFILE=/var/run/$NAME."/>
<link href="https://fonts.googleapis.com/css?family=Ubuntu:300,400,300italic,400italic|Raleway:200,300" rel="stylesheet">

	<link rel="stylesheet" type="text/css" media="screen" href="https://www.hellojxl.com/css/normalize.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="https://www.hellojxl.com/css/main.css" /><link rel="stylesheet" type="text/css" href="https://www.hellojxl.com/css/dark.css" media="(prefers-color-scheme: dark)" />

	<script src="https://www.hellojxl.com/js/feather.min.js"></script>
	
	<script src="https://www.hellojxl.com/js/main.js"></script>
	<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
</head>

<body>
	<div class="container wrapper post">
		<div class="header">
	<h1 class="site-title"><a href="https://www.hellojxl.com/">hellojxl</a></h1>
	<div class="site-description"><h2></h2><nav class="nav social">
			<ul class="flat"><a href="https://github.com/jxl922/" title="Github"><i data-feather="github"></i></a><a href="https://twitter.com/hellojxl" title="Twitter"><i data-feather="twitter"></i></a></ul>
		</nav>
	</div>

	<nav class="nav">
		<ul class="flat">
			
			<li>
				<a href="/">首页</a>
			</li>
			
			<li>
				<a href="/posts">所有文章</a>
			</li>
			
			<li>
				<a href="/tags">标签</a>
			</li>
			
			<li>
				<a href="/about">关于我</a>
			</li>
			
		</ul>
	</nav>
</div>


		<div class="post-header">
			<h1 class="title">v2ray安装注意记录</h1>
			<div class="meta">Posted at &mdash; Jul 27, 2018</div>
		</div>

		<div class="markdown">
			<h4 id="原因">原因</h4>
<p>新购了一个国外VPS，肯定要(你懂的)，主机商提供了三种系统，Ubuntu、Debian和Centos，由于某些原因三种系统都轮流安装了一遍，或者说都虐了一遍了，其中经历惨不忍睹啊！</p>
<h4 id="相关问题">相关问题</h4>
<p>不得不说<a href="https://www.v2ray.com">v2ray</a>的官方文档还是很齐全的，但是由于linux的版本太多过程还是会遇到问题的，所以具体的安装文档还是参照官方文档，我这里只是记录遇到的问题</p>
<ul>
<li>问题一：Centos7下Nginx下无法进行数据转发，报Permission Denied<br>
解决方法：可以<a href="https://toutyrater.github.io/advanced/wss_and_web.html">参考白话配置</a>,不过我这里由于是VPS的问题，SELinux被主机商禁用了，开启不了，只能更换系统</li>
<li>问题二：Debian下SSL版本低，这个算不上问题，只是我这升级完ssl出现好多问题，果断更换系统，没办法，自己太菜🐶，关键是不明白什么主机商提供的Debian8的ssl协议竟然这么低。</li>
<li>问题三：Centos6下提示出错：Install daemon fail, please install it manually<br>
解决方法：原来是因为不支持centos6，参考<a href="https://www.feiqy.com/v2ray/">这里</a>，具体如下： 
新建/etc/init.d/v2ray,并添加下面的配置</li>
</ul>
<div class="highlight"><pre style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#719e07">#!/bin/sh
</span><span style="color:#719e07"></span>#
<span style="color:#586e75"># v2ray        Startup script for v2ray</span>
#
<span style="color:#586e75"># chkconfig: - 24 76</span>
<span style="color:#586e75"># processname: v2ray</span>
<span style="color:#586e75"># pidfile: /var/run/v2ray.pid</span>
<span style="color:#586e75"># description: V2Ray proxy services</span>
#
 
<span style="color:#586e75">### BEGIN INIT INFO</span>
<span style="color:#586e75"># Provides:          v2ray</span>
<span style="color:#586e75"># Required-Start:    $network $local_fs $remote_fs</span>
<span style="color:#586e75"># Required-Stop:     $remote_fs</span>
<span style="color:#586e75"># Default-Start:     2 3 4 5</span>
<span style="color:#586e75"># Default-Stop:      0 1 6</span>
<span style="color:#586e75"># Short-Description: V2Ray proxy services</span>
<span style="color:#586e75"># Description:       V2Ray proxy services</span>
<span style="color:#586e75">### END INIT INFO</span>
 
<span style="color:#268bd2">DESC</span><span style="color:#719e07">=</span>v2ray
<span style="color:#268bd2">NAME</span><span style="color:#719e07">=</span>v2ray
<span style="color:#268bd2">DAEMON</span><span style="color:#719e07">=</span>/usr/bin/v2ray/v2ray
<span style="color:#268bd2">PIDFILE</span><span style="color:#719e07">=</span>/var/run/<span style="color:#268bd2">$NAME</span>.pid
<span style="color:#268bd2">LOCKFILE</span><span style="color:#719e07">=</span>/var/lock/subsys/<span style="color:#268bd2">$NAME</span>
<span style="color:#268bd2">SCRIPTNAME</span><span style="color:#719e07">=</span>/etc/init.d/<span style="color:#268bd2">$NAME</span>
<span style="color:#268bd2">RETVAL</span><span style="color:#719e07">=</span>0
 
<span style="color:#268bd2">DAEMON_OPTS</span><span style="color:#719e07">=</span><span style="color:#2aa198">&#34;-config /etc/v2ray/config.json&#34;</span>
 
<span style="color:#586e75"># Exit if the package is not installed</span>
<span style="color:#719e07">[</span> -x <span style="color:#268bd2">$DAEMON</span> <span style="color:#719e07">]</span> <span style="color:#719e07">||</span> <span style="color:#b58900">exit</span> 0
 
<span style="color:#586e75"># Read configuration variable file if it is present</span>
<span style="color:#719e07">[</span> -r /etc/default/<span style="color:#268bd2">$NAME</span> <span style="color:#719e07">]</span> <span style="color:#719e07">&amp;&amp;</span> . /etc/default/<span style="color:#268bd2">$NAME</span>
 
<span style="color:#586e75"># Source function library.</span>
. /etc/rc.d/init.d/functions
 
start<span style="color:#719e07">(</span><span style="color:#719e07">)</span> <span style="color:#719e07">{</span>
  <span style="color:#b58900">local</span> <span style="color:#268bd2">pids</span><span style="color:#719e07">=</span><span style="color:#719e07">$(</span>pgrep -f <span style="color:#268bd2">$DAEMON</span><span style="color:#719e07">)</span>
  <span style="color:#719e07">if</span> <span style="color:#719e07">[</span> -n <span style="color:#2aa198">&#34;</span><span style="color:#268bd2">$pids</span><span style="color:#2aa198">&#34;</span> <span style="color:#719e07">]</span>; <span style="color:#719e07">then</span>
    <span style="color:#b58900">echo</span> <span style="color:#2aa198">&#34;</span><span style="color:#268bd2">$NAME</span><span style="color:#2aa198"> (pid </span><span style="color:#268bd2">$pids</span><span style="color:#2aa198">) is already running</span><span style="color:#2aa198">&#34;</span>
    <span style="color:#268bd2">RETVAL</span><span style="color:#719e07">=</span>0
    <span style="color:#719e07">return</span> 0
  <span style="color:#719e07">fi</span>
 
  <span style="color:#b58900">echo</span> -n $<span style="color:#2aa198">&#34;</span><span style="color:#2aa198">Starting </span><span style="color:#268bd2">$NAME</span><span style="color:#2aa198">: </span><span style="color:#2aa198">&#34;</span>
 
  mkdir -p /var/log/v2ray
  <span style="color:#268bd2">$DAEMON</span> <span style="color:#268bd2">$DAEMON_OPTS</span> 1&gt;/dev/null 2&gt;&amp;<span style="color:#2aa198">1</span> &amp;
  <span style="color:#b58900">echo</span> <span style="color:#268bd2">$!</span> &gt; <span style="color:#268bd2">$PIDFILE</span>
 
  sleep 2
  pgrep -f <span style="color:#268bd2">$DAEMON</span> &gt;/dev/null 2&gt;&amp;1
  <span style="color:#268bd2">RETVAL</span><span style="color:#719e07">=</span><span style="color:#268bd2">$?</span>
  <span style="color:#719e07">if</span> <span style="color:#719e07">[</span> <span style="color:#268bd2">$RETVAL</span> -eq <span style="color:#2aa198">0</span> <span style="color:#719e07">]</span>; <span style="color:#719e07">then</span>
    success; <span style="color:#b58900">echo</span>
    touch <span style="color:#268bd2">$LOCKFILE</span>
  <span style="color:#719e07">else</span>
    failure; <span style="color:#b58900">echo</span>
  <span style="color:#719e07">fi</span>
  <span style="color:#719e07">return</span> <span style="color:#268bd2">$RETVAL</span>
<span style="color:#719e07">}</span>
 
stop<span style="color:#719e07">(</span><span style="color:#719e07">)</span> <span style="color:#719e07">{</span>
  <span style="color:#b58900">local</span> <span style="color:#268bd2">pids</span><span style="color:#719e07">=</span><span style="color:#719e07">$(</span>pgrep -f <span style="color:#268bd2">$DAEMON</span><span style="color:#719e07">)</span>
  <span style="color:#719e07">if</span> <span style="color:#719e07">[</span> -z <span style="color:#2aa198">&#34;</span><span style="color:#268bd2">$pids</span><span style="color:#2aa198">&#34;</span> <span style="color:#719e07">]</span>; <span style="color:#719e07">then</span>
    <span style="color:#b58900">echo</span> <span style="color:#2aa198">&#34;</span><span style="color:#268bd2">$NAME</span><span style="color:#2aa198"> is not running</span><span style="color:#2aa198">&#34;</span>
    <span style="color:#268bd2">RETVAL</span><span style="color:#719e07">=</span>0
    <span style="color:#719e07">return</span> 0
  <span style="color:#719e07">fi</span>
 
  <span style="color:#b58900">echo</span> -n $<span style="color:#2aa198">&#34;</span><span style="color:#2aa198">Stopping </span><span style="color:#268bd2">$NAME</span><span style="color:#2aa198">: </span><span style="color:#2aa198">&#34;</span>
  killproc -p <span style="color:#2aa198">${</span><span style="color:#268bd2">PIDFILE</span><span style="color:#2aa198">}</span> <span style="color:#2aa198">${</span><span style="color:#268bd2">NAME</span><span style="color:#2aa198">}</span>
  <span style="color:#268bd2">RETVAL</span><span style="color:#719e07">=</span><span style="color:#268bd2">$?</span>
  <span style="color:#b58900">echo</span>
  <span style="color:#719e07">[</span> <span style="color:#268bd2">$RETVAL</span> <span style="color:#719e07">=</span> <span style="color:#2aa198">0</span> <span style="color:#719e07">]</span> <span style="color:#719e07">&amp;&amp;</span> rm -f <span style="color:#2aa198">${</span><span style="color:#268bd2">LOCKFILE</span><span style="color:#2aa198">}</span> <span style="color:#2aa198">${</span><span style="color:#268bd2">PIDFILE</span><span style="color:#2aa198">}</span>
<span style="color:#719e07">}</span>
 
reload<span style="color:#719e07">(</span><span style="color:#719e07">)</span> <span style="color:#719e07">{</span>
  <span style="color:#b58900">echo</span> -n $<span style="color:#2aa198">&#34;</span><span style="color:#2aa198">Reloading </span><span style="color:#268bd2">$NAME</span><span style="color:#2aa198">: </span><span style="color:#2aa198">&#34;</span>
  killproc -p <span style="color:#2aa198">${</span><span style="color:#268bd2">PIDFILE</span><span style="color:#2aa198">}</span> <span style="color:#2aa198">${</span><span style="color:#268bd2">NAME</span><span style="color:#2aa198">}</span> -HUP
  <span style="color:#268bd2">RETVAL</span><span style="color:#719e07">=</span><span style="color:#268bd2">$?</span>
  <span style="color:#b58900">echo</span>
<span style="color:#719e07">}</span>
 
rh_status<span style="color:#719e07">(</span><span style="color:#719e07">)</span> <span style="color:#719e07">{</span>
  status -p <span style="color:#2aa198">${</span><span style="color:#268bd2">PIDFILE</span><span style="color:#2aa198">}</span> <span style="color:#2aa198">${</span><span style="color:#268bd2">DAEMON</span><span style="color:#2aa198">}</span>
<span style="color:#719e07">}</span>
 
<span style="color:#586e75"># See how we were called.</span>
<span style="color:#719e07">case</span> <span style="color:#2aa198">&#34;</span><span style="color:#268bd2">$1</span><span style="color:#2aa198">&#34;</span> in
  start<span style="color:#719e07">)</span>
    rh_status &gt;/dev/null 2&gt;&amp;<span style="color:#2aa198">1</span> <span style="color:#719e07">&amp;&amp;</span> <span style="color:#b58900">exit</span> 0
    start
    ;;
  stop<span style="color:#719e07">)</span>
    stop
    ;;
  status<span style="color:#719e07">)</span>
    rh_status
    <span style="color:#268bd2">RETVAL</span><span style="color:#719e07">=</span><span style="color:#268bd2">$?</span>
    ;;
  restart<span style="color:#719e07">)</span>
    stop
    start
    ;;
  reload<span style="color:#719e07">)</span>
    reload
  ;;
  *<span style="color:#719e07">)</span>
    <span style="color:#b58900">echo</span> <span style="color:#2aa198">&#34;</span><span style="color:#2aa198">Usage: </span><span style="color:#268bd2">$SCRIPTNAME</span><span style="color:#2aa198"> {start|stop|status|reload|restart}</span><span style="color:#2aa198">&#34;</span> &gt;&amp;2
    <span style="color:#268bd2">RETVAL</span><span style="color:#719e07">=</span>2
  ;;
<span style="color:#719e07">esac</span>
<span style="color:#b58900">exit</span> <span style="color:#268bd2">$RETVAL</span>
</code></pre></div><p>增加权限并加入开机启动</p>
<div class="highlight"><pre style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">chmod a+x /etc/init.d/v2ray
chkconfig v2ray on
service v2ray start
</code></pre></div><h4 id="结束">结束</h4>
<p>哈哈，有点水，为了折腾这个折腾了2天，本来ubuntu挺好的，因为速度有点慢就换成别的系统准备退费，结果😓，好了，吃🍉</p>
<h4 id="引用">引用</h4>
<ol>
<li>扉启博客 <a href="https://www.feiqy.com/v2ray/">https://www.feiqy.com/v2ray/</a></li>
</ol>

		</div>

		<div class="post-tags">
			
				
					<nav class="nav tags">
							<ul class="flat">
								
								<li><a href="/tags/linux">linux</a></li>
								
								<li><a href="/tags/vps">vps</a></li>
								
							</ul>
					</nav>
				
			
		</div>
		<div id="disqus_thread"></div>
<script type="text/javascript">
	(function () {
		
		
		if (window.location.hostname == "localhost")
			return;

		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
		var disqus_shortname = 'localhost';
		dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by
		Disqus.</a></noscript>
<a href="http://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	<div class="footer wrapper">
	<nav class="nav">
		<div> © Copyright hellojxl |  <a href="https://github.com/vividvilla/ezhil">Ezhil theme</a> | Built with <a href="https://gohugo.io">Hugo</a></div>
	</nav>
</div>



<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-155998474-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

<script>feather.replace()</script>
</body>
</html>
